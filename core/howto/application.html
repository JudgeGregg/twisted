<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using the Twisted Application Framework &mdash; Twisted 22.8.0.post0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" defer hack=""></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Writing a twistd Plugin" href="tap.html" />
    <link rel="prev" title="The Basics" href="basics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Twisted
          </a>
              <div class="version">
                22.8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installing Twisted</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Twisted Core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Developer Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="vision.html">The Vision For Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="servers.html">Writing Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="clients.html">Writing Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="trial.html">Test-driven development with Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/index.html">Twisted from Scratch, or The Evolution of Finger</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/intro.html">The Evolution of Finger: building a simple finger service</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/protocol.html">The Evolution of Finger: adding features to the finger service</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/style.html">The Evolution of Finger: cleaning up the finger code</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/components.html">The Evolution of Finger: moving to a component based architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/backends.html">The Evolution of Finger: pluggable backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/web.html">The Evolution of Finger: a web frontend</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/pb.html">The Evolution of Finger: Twisted client support using Perspective Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/factory.html">The Evolution of Finger: using a single factory for multiple protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/client.html">The Evolution of Finger: a Twisted finger client</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/library.html">The Evolution of Finger: making a finger library</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/configuration.html">The Evolution of Finger: configuration of the finger service</a></li>
<li class="toctree-l3"><a class="reference internal" href="quotes.html">Setting up the TwistedQuotes application</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html">Designing Twisted Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="internet-overview.html">Overview of Twisted Internet</a></li>
<li class="toctree-l3"><a class="reference internal" href="reactor-basics.html">Reactor Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="ssl.html">Using TLS in Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="udp.html">UDP Networking</a></li>
<li class="toctree-l3"><a class="reference internal" href="process.html">Using Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="defer-intro.html">Introduction to Deferreds</a></li>
<li class="toctree-l3"><a class="reference internal" href="defer.html">Deferred Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="gendefer.html">Generating Deferreds</a></li>
<li class="toctree-l3"><a class="reference internal" href="time.html">Scheduling tasks for the future</a></li>
<li class="toctree-l3"><a class="reference internal" href="threading.html">Using Threads in Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="producers.html">Producers and Consumers: Efficient High-Volume Streaming</a></li>
<li class="toctree-l3"><a class="reference internal" href="choosing-reactor.html">Choosing a Reactor and GUI Toolkit Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="endpoints.html">Getting Connected with Endpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="components.html">Components: Interfaces and Adapters</a></li>
<li class="toctree-l3"><a class="reference internal" href="cred.html">Cred: Pluggable Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin.html">The Twisted Plugin System</a></li>
<li class="toctree-l3"><a class="reference internal" href="basics.html">The Basics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using the Twisted Application Framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-services-and-application">Using Services and Application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tap.html">Writing a twistd Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="systemd.html">Deploying Twisted with systemd</a></li>
<li class="toctree-l3"><a class="reference internal" href="logger.html">Logging with twisted.logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging.html">Twisted’s Legacy Logging System: <code class="docutils literal notranslate"><span class="pre">twisted.python.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="constants.html">Symbolic Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="rdbms.html">twisted.enterprise.adbapi: Twisted RDBMS support</a></li>
<li class="toctree-l3"><a class="reference internal" href="options.html">Parsing command-lines with usage.Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="dirdbm.html">DirDBM: Directory-based Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html">Writing tests for Twisted code using Trial</a></li>
<li class="toctree-l3"><a class="reference internal" href="sendmsg.html">Extremely Low-Level Socket Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="amp.html">Asynchronous Messaging Protocol Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb.html">Overview of Twisted Spread</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-intro.html">Introduction to Perspective Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-usage.html">Using Perspective Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-clients.html">Managing Clients of Perspectives</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-copyable.html">PB Copyable: Passing Complex Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-cred.html">Authentication with Perspective Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-limits.html">PB Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="python3.html">Porting to Python 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="positioning.html">Twisted Positioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="glossary.html">Twisted Glossary</a></li>
<li class="toctree-l3"><a class="reference internal" href="debug-with-emacs.html">Debugging Python(Twisted) with Emacs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../specifications/index.html">Specifications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../conch/index.html">Twisted Conch (SSH and Telnet)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mail/index.html">Twisted Mail (SMTP, POP, and IMAP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../names/index.html">Twisted Names (DNS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pair/index.html">Twisted Pair</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../web/index.html">Twisted Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../words/index.html">Twisted Words (IRC and XMPP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development of Twisted</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sponsors/index.html">Sponsors of Twisted</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../historic/index.html">Historical Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Report a security issue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html#security-procedure-for-developers">Security Procedure for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html#security-audit">Security Audit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Twisted Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/twisted/twisted">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/twisted">PyPI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Twisted</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Twisted Core</a> &raquo;</li>
          <li><a href="index.html">Developer Guides</a> &raquo;</li>
      <li>Using the Twisted Application Framework</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/core/howto/application.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-the-twisted-application-framework">
<h1>Using the Twisted Application Framework<a class="headerlink" href="#using-the-twisted-application-framework" title="Permalink to this headline"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<section id="audience">
<h3>Audience<a class="headerlink" href="#audience" title="Permalink to this headline"></a></h3>
<p>The target audience of this document is a Twisted user who wants to deploy a significant amount of Twisted code in a re-usable, standard and easily configurable fashion.
A Twisted user who wishes to use the Application framework needs to be familiar with developing Twisted <a class="reference internal" href="servers.html"><span class="doc">servers</span></a> and/or <a class="reference internal" href="clients.html"><span class="doc">clients</span></a>.</p>
</section>
<section id="goals">
<h3>Goals<a class="headerlink" href="#goals" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>To introduce the Twisted Application infrastructure.</p></li>
<li><p>To explain how to deploy your Twisted application using <code class="docutils literal notranslate"><span class="pre">.tac</span></code> files and <code class="docutils literal notranslate"><span class="pre">twistd</span></code>.</p></li>
<li><p>To outline the existing Twisted services.</p></li>
</ul>
</section>
</section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>The Twisted Application infrastructure takes care of running and stopping your application.
Using this infrastructure frees you from from having to write a large amount of boilerplate code by hooking your application into existing tools that manage daemonization, logging, <a class="reference internal" href="choosing-reactor.html"><span class="doc">choosing a reactor</span></a> and more.</p>
<p>The major tool that manages Twisted applications is a command-line utility called <code class="docutils literal notranslate"><span class="pre">twistd</span></code>.
<code class="docutils literal notranslate"><span class="pre">twistd</span></code> is cross platform, and is the recommended tool for running Twisted applications.</p>
<p>The core component of the Twisted Application infrastructure is the <code class="xref py py-func docutils literal notranslate"><span class="pre">twisted.application.service.Application()</span></code> object –  an object which represents your application.
However, Application doesn’t provide anything that you’d want to manipulate directly.
Instead, Application acts as a container of any “Services” (objects implementing <code class="xref py py-class docutils literal notranslate"><span class="pre">IService</span></code>) that your application provides.
Most of your interaction with the Application infrastructure will be done through Services.</p>
<p>By “Service”, we mean anything in your application that can be started and stopped.
Typical services include web servers, FTP servers and SSH clients.
Your Application object can contain many services, and can even contain structured hierarchies of Services using <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiService</span></code> or your own custom <code class="xref py py-class docutils literal notranslate"><span class="pre">IServiceCollection</span></code> implementations.
You will most likely want to use these to manage Services which are dependent on other Services.
For example, a proxying Twisted application might want its server Service to only start up after the associated Client service.</p>
<p>An <code class="xref py py-class docutils literal notranslate"><span class="pre">IService</span></code> has two basic methods, <code class="docutils literal notranslate"><span class="pre">startService()</span></code> which is used to start the service, and <code class="docutils literal notranslate"><span class="pre">stopService()</span></code> which is used to stop the service.
The latter can return a <code class="xref py py-class docutils literal notranslate"><span class="pre">Deferred</span></code>, indicating service shutdown is not over until the result fires.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.internet</span> <span class="kn">import</span> <span class="n">reactor</span>
<span class="kn">from</span> <span class="nn">twisted.application</span> <span class="kn">import</span> <span class="n">service</span>
<span class="kn">from</span> <span class="nn">somemodule</span> <span class="kn">import</span> <span class="n">EchoFactory</span>

<span class="k">class</span> <span class="nc">EchoService</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">Service</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portNum</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portNum</span> <span class="o">=</span> <span class="n">portNum</span>

    <span class="k">def</span> <span class="nf">startService</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">reactor</span><span class="o">.</span><span class="n">listenTCP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portNum</span><span class="p">,</span> <span class="n">EchoFactory</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">stopService</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="o">.</span><span class="n">stopListening</span><span class="p">()</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="servers.html"><span class="doc">Writing Servers</span></a> for an explanation of <code class="docutils literal notranslate"><span class="pre">EchoFactory</span></code> and <code class="docutils literal notranslate"><span class="pre">listenTCP</span></code>.</p>
</section>
<section id="using-services-and-application">
<h2>Using Services and Application<a class="headerlink" href="#using-services-and-application" title="Permalink to this headline"></a></h2>
<section id="twistd-and-tac">
<h3>twistd and tac<a class="headerlink" href="#twistd-and-tac" title="Permalink to this headline"></a></h3>
<p id="core-howto-application-twistd">To handle start-up and configuration of your Twisted application, the Twisted Application infrastructure uses <code class="docutils literal notranslate"><span class="pre">.tac</span></code> files.
<code class="docutils literal notranslate"><span class="pre">.tac</span></code> are Python files which configure an <code class="xref py py-func docutils literal notranslate"><span class="pre">Application</span></code> object and assign this object to the top-level variable “<code class="docutils literal notranslate"><span class="pre">application</span></code>” .</p>
<p>The following is a simple example of a <code class="docutils literal notranslate"><span class="pre">.tac</span></code> file:</p>
<p><a class="reference download internal" download="" href="../../_downloads/8c02c1127125269c7a9998cc8b089307/service.tac"><code class="xref download docutils literal notranslate"><span class="pre">service.tac</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can run this .tac file directly with:</span>
<span class="c1">#    twistd -ny service.tac</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is an example .tac file which starts a webserver on port 8080 and</span>
<span class="sd">serves files from the current working directory.</span>

<span class="sd">The important part of this, the part that makes it a .tac file, is</span>
<span class="sd">the final root-level section, which sets up the object called &#39;application&#39;</span>
<span class="sd">which twistd will look for</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">twisted.application</span> <span class="kn">import</span> <span class="n">internet</span><span class="p">,</span> <span class="n">service</span>
<span class="kn">from</span> <span class="nn">twisted.web</span> <span class="kn">import</span> <span class="n">server</span><span class="p">,</span> <span class="n">static</span>


<span class="k">def</span> <span class="nf">getWebService</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a service suitable for creating an application object.</span>

<span class="sd">    This service is a simple web server that serves files on port 8080 from</span>
<span class="sd">    underneath the current working directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create a resource to serve static files</span>
    <span class="n">fileServer</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">Site</span><span class="p">(</span><span class="n">static</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">internet</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">(</span><span class="mi">8080</span><span class="p">,</span> <span class="n">fileServer</span><span class="p">)</span>


<span class="c1"># this is the core part of any tac file, the creation of the root-level</span>
<span class="c1"># application object</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">Application</span><span class="p">(</span><span class="s2">&quot;Demo application&quot;</span><span class="p">)</span>

<span class="c1"># attach the service to its parent application</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">getWebService</span><span class="p">()</span>
<span class="n">service</span><span class="o">.</span><span class="n">setServiceParent</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">twistd</span></code> is a program that runs Twisted applications using a <code class="docutils literal notranslate"><span class="pre">.tac</span></code> file. In its most simple form, it takes a single argument <code class="docutils literal notranslate"><span class="pre">-y</span></code> and a tac file name.
For example, you can run the above server with the command <code class="docutils literal notranslate"><span class="pre">twistd</span> <span class="pre">-y</span> <span class="pre">service.tac</span></code>.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">twistd</span></code> daemonizes and logs to a file called <code class="docutils literal notranslate"><span class="pre">twistd.log</span></code>.
More usually, when debugging, you will want your application to run in the foreground and log to the command line.
To run the above file like this, use the command <code class="docutils literal notranslate"><span class="pre">twistd</span> <span class="pre">-noy</span> <span class="pre">service.tac</span></code>.</p>
<p>For more information, see the <code class="docutils literal notranslate"><span class="pre">twistd</span></code> man page.</p>
</section>
<section id="customizing-twistd-logging">
<h3>Customizing <code class="docutils literal notranslate"><span class="pre">twistd</span></code>  logging<a class="headerlink" href="#customizing-twistd-logging" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">twistd</span></code> logging can be customized using the command line.
This requires that a <em>log observer factory</em> be importable.
Given a file named <code class="docutils literal notranslate"><span class="pre">my.py</span></code> with the code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.logger</span> <span class="kn">import</span> <span class="n">textFileLogObserver</span>

<span class="k">def</span> <span class="nf">logger</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">textFileLogObserver</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/my.log&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Invoking <code class="docutils literal notranslate"><span class="pre">twistd</span> <span class="pre">--logger</span> <span class="pre">my.logger</span> <span class="pre">...</span></code> will log to a file named <code class="docutils literal notranslate"><span class="pre">/tmp/my.log</span></code> (this simple example could easily be replaced with use of the <code class="docutils literal notranslate"><span class="pre">--logfile</span></code> parameter to twistd).</p>
<p>Alternatively, the logging behavior can be customized through an API accessible from <code class="docutils literal notranslate"><span class="pre">.tac</span></code> files.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">ILogObserver</span></code> component can be set on an Application in order to customize the default log observer that <code class="docutils literal notranslate"><span class="pre">twistd</span></code> will use.</p>
<p>Here is an example of how to use <code class="xref py py-class docutils literal notranslate"><span class="pre">DailyLogFile</span></code>, which rotates the log once per day.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.application.service</span> <span class="kn">import</span> <span class="n">Application</span>
<span class="kn">from</span> <span class="nn">twisted.logger</span> <span class="kn">import</span> <span class="n">ILogObserver</span><span class="p">,</span> <span class="n">textFileLogObserver</span>
<span class="kn">from</span> <span class="nn">twisted.python.logfile</span> <span class="kn">import</span> <span class="n">DailyLogFile</span>

<span class="n">application</span> <span class="o">=</span> <span class="n">Application</span><span class="p">(</span><span class="s2">&quot;myapp&quot;</span><span class="p">)</span>
<span class="n">logfile</span> <span class="o">=</span> <span class="n">DailyLogFile</span><span class="p">(</span><span class="s2">&quot;my.log&quot;</span><span class="p">,</span> <span class="s2">&quot;/tmp&quot;</span><span class="p">)</span>
<span class="n">application</span><span class="o">.</span><span class="n">setComponent</span><span class="p">(</span><span class="n">ILogObserver</span><span class="p">,</span> <span class="n">textFileLogObserver</span><span class="p">(</span><span class="n">logfile</span><span class="p">))</span>
</pre></div>
</div>
<p>Invoking <code class="docutils literal notranslate"><span class="pre">twistd</span> <span class="pre">-y</span> <span class="pre">my.tac</span></code> will create a log file at <code class="docutils literal notranslate"><span class="pre">/tmp/my.log</span></code>.</p>
</section>
<section id="services-provided-by-twisted">
<h3>Services provided by Twisted<a class="headerlink" href="#services-provided-by-twisted" title="Permalink to this headline"></a></h3>
<p>Twisted also provides pre-written <code class="xref py py-class docutils literal notranslate"><span class="pre">IService</span></code> implementations for common cases like listening on a TCP port, in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">twisted.application.internet</span></code> module.
Here’s a simple example of constructing a service that runs an echo server on TCP port 7001:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.application</span> <span class="kn">import</span> <span class="n">internet</span><span class="p">,</span> <span class="n">service</span>
<span class="kn">from</span> <span class="nn">somemodule</span> <span class="kn">import</span> <span class="n">EchoFactory</span>

<span class="n">port</span> <span class="o">=</span> <span class="mi">7001</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">EchoFactory</span><span class="p">()</span>

<span class="n">echoService</span> <span class="o">=</span> <span class="n">internet</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">factory</span><span class="p">)</span> <span class="c1"># create the service</span>
</pre></div>
</div>
<p>Each of these services (except TimerService) has a corresponding “connect” or “listen” method on the reactor, and the constructors for the services take the same arguments as the reactor methods.
The “connect” methods are for clients and the “listen” methods are for servers.
For example, <code class="docutils literal notranslate"><span class="pre">TCPServer</span></code> corresponds to <code class="docutils literal notranslate"><span class="pre">reactor.listenTCP</span></code> and <code class="docutils literal notranslate"><span class="pre">TCPClient</span></code> corresponds to <code class="docutils literal notranslate"><span class="pre">reactor.connectTCP</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">TCPServer</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">TCPClient</span></code></p>
<blockquote>
<div><p>Services which allow you to make connections and listen for connections
on TCP ports.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">listenTCP</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">connectTCP</span></code></p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">UNIXServer</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">UNIXClient</span></code></p>
<blockquote>
<div><p>Services which listen and make connections over UNIX sockets.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">listenUNIX</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">connectUNIX</span></code></p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">SSLServer</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">SSLClient</span></code></p>
<blockquote>
<div><p>Services which allow you to make SSL connections and run SSL servers.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">listenSSL</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">connectSSL</span></code></p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">UDPServer</span></code></p>
<blockquote>
<div><p>A service which allows you to send and receive data over UDP.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">listenUDP</span></code></p></li>
</ul>
<p>See also the <a class="reference internal" href="udp.html"><span class="doc">UDP documentation</span></a>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">UNIXDatagramServer</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">UNIXDatagramClient</span></code></p>
<blockquote>
<div><p>Services which send and receive data over UNIX datagram sockets.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">listenUNIXDatagram</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">connectUNIXDatagram</span></code></p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">MulticastServer</span></code></p>
<blockquote>
<div><p>A server for UDP socket methods that support multicast.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">listenMulticast</span></code></p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">TimerService</span></code></p>
<blockquote>
<div><p>A service to periodically call a function.</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TimerService</span></code></p></li>
</ul>
</div></blockquote>
</section>
<section id="service-collection">
<h3>Service Collection<a class="headerlink" href="#service-collection" title="Permalink to this headline"></a></h3>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">IServiceCollection</span></code> objects contain <code class="xref py py-class docutils literal notranslate"><span class="pre">IService</span></code> objects.
IService objects can be added to IServiceCollection by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">setServiceParent</span></code> and detached by using <code class="xref py py-meth docutils literal notranslate"><span class="pre">disownServiceParent</span></code>.</p>
<p>The standard implementation of IServiceCollection is <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiService</span></code>, which also implements IService.
MultiService is useful for creating a new Service which combines two or more existing Services.
For example, you could create a DNS Service as a MultiService which has a TCP and a UDP Service as children.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.application</span> <span class="kn">import</span> <span class="n">internet</span><span class="p">,</span> <span class="n">service</span>
<span class="kn">from</span> <span class="nn">twisted.names</span> <span class="kn">import</span> <span class="n">server</span><span class="p">,</span> <span class="n">dns</span><span class="p">,</span> <span class="n">hosts</span>

<span class="n">port</span> <span class="o">=</span> <span class="mi">53</span>

<span class="c1"># Create a MultiService, and hook up a TCPServer and a UDPServer to it as</span>
<span class="c1"># children.</span>
<span class="n">dnsService</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">MultiService</span><span class="p">()</span>
<span class="n">hostsResolver</span> <span class="o">=</span> <span class="n">hosts</span><span class="o">.</span><span class="n">Resolver</span><span class="p">(</span><span class="s1">&#39;/etc/hosts&#39;</span><span class="p">)</span>
<span class="n">tcpFactory</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">DNSServerFactory</span><span class="p">([</span><span class="n">hostsResolver</span><span class="p">])</span>
<span class="n">internet</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">tcpFactory</span><span class="p">)</span><span class="o">.</span><span class="n">setServiceParent</span><span class="p">(</span><span class="n">dnsService</span><span class="p">)</span>
<span class="n">udpFactory</span> <span class="o">=</span> <span class="n">dns</span><span class="o">.</span><span class="n">DNSDatagramProtocol</span><span class="p">(</span><span class="n">tcpFactory</span><span class="p">)</span>
<span class="n">internet</span><span class="o">.</span><span class="n">UDPServer</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">udpFactory</span><span class="p">)</span><span class="o">.</span><span class="n">setServiceParent</span><span class="p">(</span><span class="n">dnsService</span><span class="p">)</span>

<span class="c1"># Create an application as normal</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">Application</span><span class="p">(</span><span class="s2">&quot;DNSExample&quot;</span><span class="p">)</span>

<span class="c1"># Connect our MultiService to the application, just like a normal service.</span>
<span class="n">dnsService</span><span class="o">.</span><span class="n">setServiceParent</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="basics.html" class="btn btn-neutral float-left" title="The Basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tap.html" class="btn btn-neutral float-right" title="Writing a twistd Plugin" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Twisted Matrix Labs. Ver 22.8.0.post0. Built on 2022-09-16.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>