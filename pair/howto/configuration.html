<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Twisted Pair: Device Configuration &mdash; Twisted 22.8.0.post0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" defer hack=""></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Examples" href="../examples/index.html" />
    <link rel="prev" title="Twisted Pair: Tunnels And Network Taps" href="tunnels.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Twisted
          </a>
              <div class="version">
                22.8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installing Twisted</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core/index.html">Twisted Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conch/index.html">Twisted Conch (SSH and Telnet)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mail/index.html">Twisted Mail (SMTP, POP, and IMAP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../names/index.html">Twisted Names (DNS)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Twisted Pair</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Developer Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tunnels.html">Twisted Pair: Tunnels And Network Taps</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Twisted Pair: Device Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#twisted-pair-s-test-suite">Twisted Pair’s Test Suite</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../web/index.html">Twisted Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../words/index.html">Twisted Words (IRC and XMPP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development of Twisted</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sponsors/index.html">Sponsors of Twisted</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../historic/index.html">Historical Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Report a security issue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html#security-procedure-for-developers">Security Procedure for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html#security-audit">Security Audit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Twisted Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/twisted/twisted">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/twisted">PyPI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Twisted</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Twisted Pair</a> &raquo;</li>
          <li><a href="index.html">Developer Guides</a> &raquo;</li>
      <li>Twisted Pair: Device Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/pair/howto/configuration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="twisted-pair-device-configuration">
<h1>Twisted Pair: Device Configuration<a class="headerlink" href="#twisted-pair-device-configuration" title="Permalink to this headline"></a></h1>
<section id="twisted-pair-s-test-suite">
<h2>Twisted Pair’s Test Suite<a class="headerlink" href="#twisted-pair-s-test-suite" title="Permalink to this headline"></a></h2>
<p>Certain system configuration is required before the full Twisted Pair test suite can be run.
Without this setup the test suite will lack the permission necessary to access tap and tun devices.
Some tests will still run but the integration tests which verify Twisted Pair can successfully read from and write to real devices will be skipped.</p>
<p>The following shell script creates two tun devices and two tap devices and grants permission to use them to whatever user the shell script is run as.
Run it to configure your system so that you can perform a complete run of the Twisted Pair test suite.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Needs to be short enough so that with prefix and suffix, fits into <span class="m">16</span> bytes
<span class="go">IDENTIFIER=&quot;twtest&quot;</span>

<span class="gp"># </span>A tap device without protocol information
<span class="go">sudo ip tuntap add dev tap-${IDENTIFIER} mode tap user $(id -u -n) group $(id -g -n)</span>
<span class="go">sudo ip link set up dev tap-${IDENTIFIER}</span>
<span class="go">sudo ip addr add 172.16.0.1/24 dev tap-${IDENTIFIER}</span>
<span class="go">sudo ip neigh add 172.16.0.2 lladdr de:ad:be:ef:ca:fe dev tap-${IDENTIFIER}</span>

<span class="gp"># </span>A tap device with protocol information
<span class="go">sudo ip tuntap add dev tap-${IDENTIFIER}-pi mode tap user $(id -u -n) group $(id -g -n) pi</span>
<span class="go">sudo ip link set up dev tap-${IDENTIFIER}-pi</span>
<span class="go">sudo ip addr add 172.16.1.1/24 dev tap-${IDENTIFIER}-pi</span>
<span class="go">sudo ip neigh add 172.16.1.2 lladdr de:ad:ca:fe:be:ef dev tap-${IDENTIFIER}-pi</span>

<span class="gp"># </span>A tun device without protocol information
<span class="go">sudo ip tuntap add dev tun-${IDENTIFIER} mode tun user $(id -u -n) group $(id -g -n)</span>
<span class="go">sudo ip link set up dev tun-${IDENTIFIER}</span>

<span class="gp"># </span>A tun device with protocol information
<span class="go">sudo ip tuntap add dev tun-${IDENTIFIER}-pi mode tun user $(id -u -n) group $(id -g -n) pi</span>
<span class="go">sudo ip link set up dev tun-${IDENTIFIER}-pi</span>
</pre></div>
</div>
<p>There are two things to keep in mind about this configuration.
First, it uses addresses from the 172.16.0.0/12 private use range.
If your network is configured to use these already then running the script may cause problems for your network.
These addresses are hard-coded into the Twisted Pair test suite so this problem is not easily avoided.
Second, the changes are not persistent across reboots.
If you want this network configuration to be available even after a reboot you will need to integrate the above into your system’s init scripts somehow
(the details of this for different systems is beyond the scope of this document).</p>
<p>Certain platforms may also require a modification to their firewall rules in order to allow the traffic the test suite wants to transmit.
Adding firewall rules which allowing traffic destined for the addresses used by the test suite should address this problem.
If you encounter timeouts when running the Twisted Pair test suite then this may apply to you.
For example, to configure an iptables firewall to allow this traffic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="n">INPUT</span> <span class="o">--</span><span class="n">dest</span> <span class="mf">172.16.1.1</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="n">INPUT</span> <span class="o">--</span><span class="n">dest</span> <span class="mf">172.16.2.1</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tunnels.html" class="btn btn-neutral float-left" title="Twisted Pair: Tunnels And Network Taps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../examples/index.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Twisted Matrix Labs. Ver 22.8.0.post0. Built on 2022-09-16.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>