

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Introduction to Perspective Broker &mdash; Twisted 22.4.0.post0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" defer hack=""></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using Perspective Broker" href="pb-usage.html" />
    <link rel="prev" title="Overview of Twisted Spread" href="pb.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Twisted
          

          
          </a>

          
            
            
              <div class="version">
                22.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installing Twisted</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Twisted Core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Developer Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="vision.html">The Vision For Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="servers.html">Writing Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="clients.html">Writing Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="trial.html">Test-driven development with Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/index.html">Twisted from Scratch, or The Evolution of Finger</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/intro.html">The Evolution of Finger: building a simple finger service</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/protocol.html">The Evolution of Finger: adding features to the finger service</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/style.html">The Evolution of Finger: cleaning up the finger code</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/components.html">The Evolution of Finger: moving to a component based architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/backends.html">The Evolution of Finger: pluggable backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/web.html">The Evolution of Finger: a web frontend</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/pb.html">The Evolution of Finger: Twisted client support using Perspective Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/factory.html">The Evolution of Finger: using a single factory for multiple protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/client.html">The Evolution of Finger: a Twisted finger client</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/library.html">The Evolution of Finger: making a finger library</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/configuration.html">The Evolution of Finger: configuration of the finger service</a></li>
<li class="toctree-l3"><a class="reference internal" href="quotes.html">Setting up the TwistedQuotes application</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html">Designing Twisted Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="internet-overview.html">Overview of Twisted Internet</a></li>
<li class="toctree-l3"><a class="reference internal" href="reactor-basics.html">Reactor Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="ssl.html">Using TLS in Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="udp.html">UDP Networking</a></li>
<li class="toctree-l3"><a class="reference internal" href="process.html">Using Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="defer-intro.html">Introduction to Deferreds</a></li>
<li class="toctree-l3"><a class="reference internal" href="defer.html">Deferred Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="gendefer.html">Generating Deferreds</a></li>
<li class="toctree-l3"><a class="reference internal" href="time.html">Scheduling tasks for the future</a></li>
<li class="toctree-l3"><a class="reference internal" href="threading.html">Using Threads in Twisted</a></li>
<li class="toctree-l3"><a class="reference internal" href="producers.html">Producers and Consumers: Efficient High-Volume Streaming</a></li>
<li class="toctree-l3"><a class="reference internal" href="choosing-reactor.html">Choosing a Reactor and GUI Toolkit Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="endpoints.html">Getting Connected with Endpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="components.html">Components: Interfaces and Adapters</a></li>
<li class="toctree-l3"><a class="reference internal" href="cred.html">Cred: Pluggable Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin.html">The Twisted Plugin System</a></li>
<li class="toctree-l3"><a class="reference internal" href="basics.html">The Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="application.html">Using the Twisted Application Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="tap.html">Writing a twistd Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="systemd.html">Deploying Twisted with systemd</a></li>
<li class="toctree-l3"><a class="reference internal" href="logger.html">Logging with twisted.logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging.html">Twisted’s Legacy Logging System: <code class="docutils literal notranslate"><span class="pre">twisted.python.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="constants.html">Symbolic Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="rdbms.html">twisted.enterprise.adbapi: Twisted RDBMS support</a></li>
<li class="toctree-l3"><a class="reference internal" href="options.html">Parsing command-lines with usage.Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="dirdbm.html">DirDBM: Directory-based Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html">Writing tests for Twisted code using Trial</a></li>
<li class="toctree-l3"><a class="reference internal" href="sendmsg.html">Extremely Low-Level Socket Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="amp.html">Asynchronous Messaging Protocol Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb.html">Overview of Twisted Spread</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Introduction to Perspective Broker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#object-roadmap">Object Roadmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#things-you-can-call-remotely">Things you can Call Remotely</a></li>
<li class="toctree-l4"><a class="reference internal" href="#things-you-can-copy-remotely">Things you can Copy Remotely</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pb-usage.html">Using Perspective Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-clients.html">Managing Clients of Perspectives</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-copyable.html">PB Copyable: Passing Complex Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-cred.html">Authentication with Perspective Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="pb-limits.html">PB Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="python3.html">Porting to Python 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="positioning.html">Twisted Positioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="glossary.html">Twisted Glossary</a></li>
<li class="toctree-l3"><a class="reference internal" href="debug-with-emacs.html">Debugging Python(Twisted) with Emacs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../specifications/index.html">Specifications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../conch/index.html">Twisted Conch (SSH and Telnet)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mail/index.html">Twisted Mail (SMTP, POP, and IMAP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../names/index.html">Twisted Names (DNS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pair/index.html">Twisted Pair</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../web/index.html">Twisted Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../words/index.html">Twisted Words (IRC and XMPP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development of Twisted</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../historic/index.html">Historical Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Report a security issue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html#security-procedure-for-developers">Security Procedure for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html#security-audit">Security Audit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Twisted Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/twisted/twisted">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/twisted">PyPI</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Twisted</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Twisted Core</a> &raquo;</li>
        
          <li><a href="index.html">Developer Guides</a> &raquo;</li>
        
      <li>Introduction to Perspective Broker</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/core/howto/pb-intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction-to-perspective-broker">
<h1>Introduction to Perspective Broker<a class="headerlink" href="#introduction-to-perspective-broker" title="Permalink to this heading">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Suppose you find yourself in control of both ends of the wire: you
have two programs that need to talk to each other, and you get to use any
protocol you want. If you can think of your problem in terms of objects that
need to make method calls on each other, then chances are good that you can
use Twisted’s Perspective Broker protocol rather than trying to shoehorn
your needs into something like HTTP, or implementing yet another RPC
mechanism <a class="footnote-reference brackets" href="#id2" id="id1">1</a> .</p>
<p>The Perspective Broker system (abbreviated “PB” , spawning numerous
sandwich-related puns) is based upon a few central concepts:</p>
<ul class="simple">
<li><p><em>serialization</em> : taking fairly arbitrary objects and types,
turning them into a chunk of bytes, sending them over a wire, then
reconstituting them on the other end. By keeping careful track of object
ids, the serialized objects can contain references to other objects and
the remote copy will still be useful.</p></li>
<li><p><em>remote method calls</em> : doing something to a local object and
causing a method to get run on a distant one. The local object is called a
<code class="xref py py-class docutils literal notranslate"><span class="pre">RemoteReference</span></code> , and you
“do something” by running its <code class="docutils literal notranslate"><span class="pre">.callRemote</span></code> method.</p></li>
</ul>
<p>This document will contain several examples that will (hopefully) appear
redundant and verbose once you’ve figured out what’s going on. To begin
with, much of the code will just be labelled “magic” : don’t worry about how
these parts work yet. It will be explained more fully later.</p>
</div>
<div class="section" id="object-roadmap">
<h2>Object Roadmap<a class="headerlink" href="#object-roadmap" title="Permalink to this heading">¶</a></h2>
<p>To start with, here are the major classes, interfaces, and
functions involved in PB, with links to the file where they are
defined (all of which are under twisted/, of course). Don’t worry
about understanding what they all do yet: it’s easier to figure them
out through their interaction than explaining them one at a time.</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code>
: <code class="docutils literal notranslate"><span class="pre">internet/protocol.py</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">PBServerFactory</span></code>
: <code class="docutils literal notranslate"><span class="pre">spread/pb.py</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Broker</span></code>
: <code class="docutils literal notranslate"><span class="pre">spread/pb.py</span></code></p></li>
</ul>
<p>Other classes that are involved at some point:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RemoteReference</span></code>
: <code class="docutils literal notranslate"><span class="pre">spread/pb.py</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pb.Root</span></code>
: <code class="docutils literal notranslate"><span class="pre">spread/pb.py</span></code> , actually defined as
<code class="docutils literal notranslate"><span class="pre">twisted.spread.flavors.Root</span></code>
in <code class="docutils literal notranslate"><span class="pre">spread/flavors.py</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pb.Referenceable</span></code>
: <code class="docutils literal notranslate"><span class="pre">spread/pb.py</span></code> , actually defined as
<code class="docutils literal notranslate"><span class="pre">twisted.spread.flavors.Referenceable</span></code>
in <code class="docutils literal notranslate"><span class="pre">spread/flavors.py</span></code></p></li>
</ul>
<p>Classes and interfaces that get involved when you start to care
about authorization and security:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Portal</span></code>
: <code class="docutils literal notranslate"><span class="pre">cred/portal.py</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">IRealm</span></code>
: <code class="docutils literal notranslate"><span class="pre">cred/portal.py</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">IPerspective</span></code>
: <code class="docutils literal notranslate"><span class="pre">spread/pb.py</span></code> , which you will usually be interacting
with via <code class="xref py py-class docutils literal notranslate"><span class="pre">pb.Avatar</span></code> (a basic implementor of the interface).</p></li>
</ul>
<div class="section" id="subclassing-and-implementing">
<h3>Subclassing and Implementing<a class="headerlink" href="#subclassing-and-implementing" title="Permalink to this heading">¶</a></h3>
<p>Technically you can subclass anything you want, but technically you
could also write a whole new framework, which would just waste a lot
of time. Knowing which classes are useful to subclass or which
interfaces to implement is one of the bits of knowledge that’s crucial
to using PB (and all of Twisted) successfully. Here are some hints to
get started:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pb.Root</span></code> , <code class="xref py py-class docutils literal notranslate"><span class="pre">pb.Referenceable</span></code> : you’ll
subclass these to make remotely-referenceable objects (i.e., objects
which you can call methods on remotely) using PB. You don’t need to
change any of the existing behavior, just inherit all of it and add
the remotely-accessible methods that you want to export.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pb.Avatar</span></code> : You’ll
be subclassing this when you get into PB programming with
authorization. This is an implementor of IPerspective.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ICredentialsChecker</span></code> : Implement this if
you want to authenticate your users against some sort of data store:
i.e., an LDAP database, an RDBMS, etc. There are already a few
implementations of this for various back-ends in
twisted.cred.checkers.</p></li>
</ul>
</div>
</div>
<div class="section" id="things-you-can-call-remotely">
<h2>Things you can Call Remotely<a class="headerlink" href="#things-you-can-call-remotely" title="Permalink to this heading">¶</a></h2>
<p>At this writing, there are three “flavors” of objects that can
be accessed remotely through <code class="xref py py-class docutils literal notranslate"><span class="pre">RemoteReference</span></code> objects. Each of these
flavors has a rule for how the <code class="docutils literal notranslate"><span class="pre">callRemote</span></code>
message is transformed into a local method call on the server.  In
order to use one of these “flavors” , subclass them and name your
published methods with the appropriate prefix.</p>
<ul>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">twisted.spread.pb.IPerspective</span></code> implementors</p>
<p>This is the first interface we deal with. It is a “perspective”
onto your PB application.  Perspectives are slightly special because
they are usually the first object that a given user can access in
your application (after they log on).  A user should only receive a
reference to their <em>own</em> perspective. PB works hard to
verify, as best it can, that any method that can be called on a
perspective directly is being called on behalf of the user who is
represented by that perspective.  (Services with unusual
requirements for “on behalf of” , such as simulations with the
ability to posses another player’s avatar, are accomplished by
providing indirected access to another user’s perspective.)</p>
<p>Perspectives are not usually serialized as remote references, so
do not return an IPerspective-implementor directly.</p>
<p>The way most people will want to implement IPerspective is by
subclassing pb.Avatar. Remotely accessible methods on pb.Avatar
instances are named with the <code class="docutils literal notranslate"><span class="pre">perspective_</span></code> prefix.</p>
</li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">twisted.spread.pb.Referenceable</span></code></p>
<p>Referenceable objects are the simplest kind of PB object.  You can call
methods on them and return them from methods to provide access to other
objects’ methods.</p>
<p>However, when a method is called on a Referenceable, it’s not possible to
tell who called it.</p>
<p>Remotely accessible methods on Referenceables are named with the
<code class="docutils literal notranslate"><span class="pre">remote_</span></code> prefix.</p>
</li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">twisted.spread.pb.Viewable</span></code></p>
<p>Viewable objects are remotely referenceable objects which have the
additional requirement that it must be possible to tell who is calling them.
The argument list to a Viewable’s remote methods is modified in order to
include the Perspective representing the calling user.</p>
<p>Remotely accessible methods on Viewables are named with the
<code class="docutils literal notranslate"><span class="pre">view_</span></code> prefix.</p>
</li>
</ul>
</div>
<div class="section" id="things-you-can-copy-remotely">
<h2>Things you can Copy Remotely<a class="headerlink" href="#things-you-can-copy-remotely" title="Permalink to this heading">¶</a></h2>
<p>In addition to returning objects that you can call remote methods on, you
can return structured copies of local objects.</p>
<p>There are 2 basic flavors that allow for copying objects remotely.  Again,
you can use these by subclassing them.  In order to specify what state you want
to have copied when these are serialized, you can either use the Python default
<code class="docutils literal notranslate"><span class="pre">__getstate__</span></code> or specialized method calls for that
flavor.</p>
<ul>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">twisted.spread.pb.Copyable</span></code></p>
<p>This is the simpler kind of object that can be copied.  Every time this
object is returned from a method or passed as an argument, it is serialized
and unserialized.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">Copyable</span></code>
provides a method you can override, <code class="docutils literal notranslate"><span class="pre">getStateToCopyFor(perspective)</span></code> , which
allows you to decide what an object will look like for the
perspective who is requesting it. The <code class="docutils literal notranslate"><span class="pre">perspective</span></code> argument will be the perspective
which is either passing an argument or returning a result an
instance of your Copyable class.</p>
<p>For security reasons, in order to allow a particular Copyable class to
actually be copied, you must declare a <code class="docutils literal notranslate"><span class="pre">RemoteCopy</span></code>
handler for
that Copyable subclass.  The easiest way to do this is to declare both in the
same module, like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.spread</span> <span class="kn">import</span> <span class="n">flavors</span>
<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">flavors</span><span class="o">.</span><span class="n">Copyable</span><span class="p">):</span>
    <span class="k">pass</span>
<span class="k">class</span> <span class="nc">RemoteFoo</span><span class="p">(</span><span class="n">flavors</span><span class="o">.</span><span class="n">RemoteCopy</span><span class="p">):</span>
    <span class="k">pass</span>
<span class="n">flavors</span><span class="o">.</span><span class="n">setUnjellyableForClass</span><span class="p">(</span><span class="n">Foo</span><span class="p">,</span> <span class="n">RemoteFoo</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, each time a Foo is copied between peers, a RemoteFoo will be
instantiated and populated with the Foo’s state.  If you do not do this, PB
will complain that there have been security violations, and it may close the
connection.</p>
</li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">twisted.spread.pb.Cacheable</span></code></p>
<p>Let me preface this with a warning: Cacheable may be hard to understand.
The motivation for it may be unclear if you don’t have some experience with
real-world applications that use remote method calling of some kind.  Once
you understand why you need it, what it does will likely seem simple and
obvious, but if you get confused by this, forget about it and come back
later.  It’s possible to use PB without understanding Cacheable at all.</p>
<p>Cacheable is a flavor which is designed to be copied only when necessary,
and updated on the fly as changes are made to it.  When passed as an argument
or a return value, if a Cacheable exists on the side of the connection it is
being copied to, it will be referred to by ID and not copied.</p>
<p>Cacheable is designed to minimize errors involved in replicating an object
between multiple servers, especially those related to having stale
information.  In order to do this, Cacheable automatically registers
observers and queries state atomically, together.  You can override the
method <code class="docutils literal notranslate"><span class="pre">getStateToCacheAndObserveFor(self,</span> <span class="pre">perspective,</span> <span class="pre">observer)</span></code> in order to specify how your observers will be
stored and updated.</p>
<p>Similar to
<code class="docutils literal notranslate"><span class="pre">getStateToCopyFor</span></code> ,
<code class="docutils literal notranslate"><span class="pre">getStateToCacheAndObserveFor</span></code> gets passed a
perspective.  It also gets passed an
<code class="docutils literal notranslate"><span class="pre">observer</span></code> , which is a remote reference to a
“secret” fourth referenceable flavor:
<code class="xref py py-class docutils literal notranslate"><span class="pre">RemoteCache</span></code> .</p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">RemoteCache</span></code> is simply
the object that represents your
<code class="xref py py-class docutils literal notranslate"><span class="pre">Cacheable</span></code> on the other side
of the connection.  It is registered using the same method as
<code class="xref py py-class docutils literal notranslate"><span class="pre">RemoteCopy</span></code> , above.
RemoteCache is different, however, in that it will be referenced by its peer.
It acts as a Referenceable, where all methods prefixed with
<code class="docutils literal notranslate"><span class="pre">observe_</span></code> will be callable remotely.  It is
recommended that your object maintain a list (note: library support for this
is forthcoming!) of observers, and update them using
<code class="docutils literal notranslate"><span class="pre">callRemote</span></code> when the Cacheable changes in a way
that should be noticeable to its clients.</p>
<p>Finally, when all references to a
<code class="xref py py-class docutils literal notranslate"><span class="pre">Cacheable</span></code> from a given
perspective are lost,
<code class="docutils literal notranslate"><span class="pre">stoppedObserving(perspective,</span> <span class="pre">observer)</span></code>
will be called on the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Cacheable</span></code> , with the same
perspective/observer pair that <code class="docutils literal notranslate"><span class="pre">getStateToCacheAndObserveFor</span></code> was
originally called with.  Any cleanup remote calls can be made there, as well
as removing the observer object from any lists which it was previously in.
Any further calls to this observer object will be invalid.</p>
</li>
</ul>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Most of Twisted is like this.  Hell, most of
Unix is like this: if <em>you</em>  think it would be useful, someone else has
probably thought that way in the past, and acted on it, and you can take
advantage of the tool they created to solve the same problem you’re facing
now.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="pb-usage.html" class="btn btn-neutral float-right" title="Using Perspective Broker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="pb.html" class="btn btn-neutral float-left" title="Overview of Twisted Spread" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Twisted Matrix Labs. Ver 22.4.0.post0. Built on 2022-09-04.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>